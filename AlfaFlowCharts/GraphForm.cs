using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using DevExpress.XtraCharts;

namespace AlfaFlowCharts
{
    public partial class GraphForm : Form
    {
        internal AlfaFlow.TemporalContextManager m_tcm;
        internal struct V
        {
            public readonly long t;
            public readonly double v;
            public V(long t, double v)
            {
                this.t = t; this.v = v;
            }
        }

        public GraphForm()
        {
            InitializeComponent();
            m_tcm = new AlfaFlow.TemporalContextManager();
            var diag = chartControl.Diagram as XYDiagram;

            diag.AxisY.Range.Auto = false;
            diag.AxisY.Range.MaxValue = 65.1;
            diag.AxisY.Range.MinValue = 64;
        }

		string smaTokenName;
        private void GraphForm_Load(object sender, EventArgs e)
        {
            #region vin
            V[] vin = new[] 
			{ 
				new V(636065368800000000,64.53000000),
				new V(636065369400000000,64.52000000),
				new V(636065370000000000,64.52000000),
				new V(636065370600000000,64.52250000),
				new V(636065371200000000,64.50750000),
				new V(636065371800000000,64.53500000),
				new V(636065372400000000,64.55000000),
				new V(636065373000000000,64.53500000),
				new V(636065373600000000,64.53000000),
				new V(636065374200000000,64.52500000),
				new V(636065374800000000,64.51250000),
				new V(636065375400000000,64.53000000),
				new V(636065376000000000,64.53000000),
				new V(636065376600000000,64.56750000),
				new V(636065377200000000,64.60500000),
				new V(636065377800000000,64.59750000),
				new V(636065378400000000,64.55500000),
				new V(636065379000000000,64.56000000),
				new V(636065379600000000,64.56750000),
				new V(636065380200000000,64.59000000),
				new V(636065380800000000,64.58000000),
				new V(636065381400000000,64.55000000),
				new V(636065382000000000,64.55000000),
				new V(636065382600000000,64.51250000),
				new V(636065383200000000,64.52000000),
				new V(636065383800000000,64.53000000),
				new V(636065384400000000,64.53000000),
				new V(636065385000000000,64.52250000),
				new V(636065385600000000,64.52500000),
				new V(636065386200000000,64.55500000),
				new V(636065386800000000,64.55500000),
				new V(636065387400000000,64.57000000),
				new V(636065388000000000,64.51000000),
				new V(636065388600000000,64.53000000),
				new V(636065389200000000,64.53000000),
				new V(636065389800000000,64.53500000),
				new V(636065390400000000,64.53000000),
				new V(636065391000000000,64.55250000),
				new V(636065391600000000,64.50250000),
				new V(636065392200000000,64.49250000),
				new V(636065392800000000,64.46750000),
				new V(636065393400000000,64.43750000),
				new V(636065394000000000,64.40250000),
				new V(636065394600000000,64.36250000),
				new V(636065395200000000,64.36500000),
				new V(636065395800000000,64.36500000),
				new V(636065396400000000,64.34000000),
				new V(636065397000000000,64.39250000),
				new V(636065397600000000,64.37750000),
				new V(636065398200000000,64.40500000),
				new V(636065398800000000,64.41000000),
				new V(636065399400000000,64.40250000),
				new V(636065400000000000,64.40750000),
				new V(636065400600000000,64.40750000),
				new V(636065401200000000,64.38750000),
				new V(636065401800000000,64.39750000),
				new V(636065402400000000,64.38000000),
				new V(636065403000000000,64.35500000),
				new V(636065403600000000,64.34750000),
				new V(636065404200000000,64.32500000),
				new V(636065404800000000,64.32250000),
				new V(636065405400000000,64.33000000),
				new V(636065406000000000,64.30750000),
				new V(636065406600000000,64.32500000),
				new V(636065407200000000,64.30750000),
				new V(636065407800000000,64.35500000),
				new V(636065408400000000,64.35500000),
				new V(636065409000000000,64.36000000),
				new V(636065409600000000,64.36500000),
				new V(636065410200000000,64.38000000),
				new V(636065410800000000,64.36000000),
				new V(636065411400000000,64.36750000),
				new V(636065412000000000,64.38000000),
				new V(636065412600000000,64.38750000),
				new V(636065413200000000,64.37250000),
				new V(636065413800000000,64.36250000),
				new V(636065414400000000,64.36500000),
				new V(636065415000000000,64.36250000),
				new V(636065415600000000,64.39750000),
				new V(636065416200000000,64.39000000),
				new V(636065416800000000,64.36500000),
				new V(636065417400000000,64.36750000),
				new V(636065418000000000,64.36500000),
				new V(636065418600000000,64.32250000),
				new V(636065419200000000,64.35000000),
				new V(636065419800000000,64.33500000),
				new V(636065420400000000,64.32750000),
				new V(636065421000000000,64.30250000),
				new V(636065421600000000,64.28250000),
				new V(636065422200000000,64.27500000),
				new V(636065422800000000,64.27500000),
				new V(636065423400000000,64.25000000),
				new V(636065424000000000,64.22500000),
				new V(636065424600000000,64.23250000),
				new V(636065425200000000,64.22000000),
				new V(636065425800000000,64.23750000),
				new V(636065426400000000,64.24000000),
				new V(636065427000000000,64.22250000),
				new V(636065427600000000,64.22500000),
				new V(636065428200000000,64.23000000),
				new V(636065428800000000,64.26750000),
				new V(636065429400000000,64.25000000),
				new V(636065430000000000,64.26000000),
				new V(636065430600000000,64.26250000),
				new V(636065431200000000,64.27250000),
				new V(636065431800000000,64.26750000),
				new V(636065432400000000,64.24750000),
				new V(636065433000000000,64.27500000),
				new V(636065433600000000,64.29000000),
				new V(636065434200000000,64.30500000),
				new V(636065434800000000,64.30000000),
				new V(636065435400000000,64.31500000),
				new V(636065436000000000,64.28750000),
				new V(636065436600000000,64.28000000),
				new V(636065437200000000,64.28000000),
				new V(636065437800000000,64.25500000),
				new V(636065438400000000,64.26250000),
				new V(636065439000000000,64.26250000),
				new V(636065439600000000,64.27250000),
				new V(636065440200000000,64.26500000),
				new V(636065440800000000,64.28000000),
				new V(636065441400000000,64.27000000),
				new V(636065442000000000,64.26000000),
				new V(636065442600000000,64.25250000),
				new V(636065443200000000,64.25000000),
				new V(636065443800000000,64.24000000),
				new V(636065444400000000,64.25000000),
				new V(636065445000000000,64.25500000),
				new V(636065445600000000,64.27500000),
				new V(636065446200000000,64.26250000),
				new V(636065446800000000,64.25750000),
				new V(636065447400000000,64.26000000),
				new V(636065448000000000,64.25500000),
				new V(636065448600000000,64.26250000),
				new V(636065449200000000,64.26750000),
				new V(636065449800000000,64.26500000),
				new V(636065450400000000,64.26000000),
				new V(636065451000000000,64.26500000),
				new V(636065451600000000,64.26500000),
				new V(636065452200000000,64.24000000),
				new V(636065453400000000,64.23000000),
				new V(636065454000000000,64.24500000),
				new V(636065454600000000,64.23750000),
				new V(636065455200000000,64.23500000),
				new V(636065455800000000,64.24000000),
				new V(636065456400000000,64.22250000),
				new V(636065457000000000,64.23000000),
				new V(636065457600000000,64.23500000),
				new V(636065458200000000,64.24000000),
				new V(636065458800000000,64.22500000),
				new V(636065459400000000,64.23500000),
				new V(636065460000000000,64.24750000),
				new V(636065460600000000,64.22500000),
				new V(636065461200000000,64.23750000),
				new V(636065461800000000,64.24500000),
				new V(636065462400000000,64.24250000),
				new V(636065463000000000,64.24000000),
				new V(636065463600000000,64.16500000),
				new V(636065464200000000,64.17000000),
				new V(636065464800000000,64.15000000),
				new V(636065465400000000,64.15000000),
				new V(636065466000000000,64.15500000),
				new V(636065466600000000,64.14750000),
				new V(636065467200000000,64.17250000),
				new V(636065467800000000,64.17750000),
				new V(636065468400000000,64.17500000),
				new V(636065469000000000,64.17500000),
				new V(636065469600000000,64.29000000),
				new V(636065470200000000,64.25500000),
				new V(636065470800000000,64.23250000),
				new V(636065471400000000,64.23500000),
				new V(636065472000000000,64.27000000),
				new V(636065472600000000,64.31500000),
				new V(636065473200000000,64.29000000),
				new V(636065473800000000,64.33750000),
				new V(636065474400000000,64.36750000),
				new V(636065475000000000,64.37000000),
				new V(636065475600000000,64.31250000),
				new V(636065476200000000,64.30000000),
				new V(636065476800000000,64.33000000),
				new V(636065477400000000,64.32500000),
				new V(636065478000000000,64.34500000),
				new V(636065478600000000,64.34750000),
				new V(636065479200000000,64.33250000),
				new V(636065479800000000,64.32000000),
				new V(636065480400000000,64.33000000),
				new V(636065481000000000,64.33500000),
				new V(636065481600000000,64.34750000),
				new V(636065482200000000,64.35000000),
				new V(636065482800000000,64.32500000),
				new V(636065483400000000,64.34500000),
				new V(636065485200000000,64.36500000),
				new V(636065485800000000,64.39000000),
				new V(636065486400000000,64.38000000),
				new V(636065487000000000,64.40000000),
				new V(636065487600000000,64.39000000),
				new V(636065488200000000,64.39750000),
				new V(636065488800000000,64.38500000),
				new V(636065489400000000,64.39500000),
				new V(636065490000000000,64.39750000),
				new V(636065490600000000,64.40000000),
				new V(636065491200000000,64.39750000),
				new V(636065491800000000,64.39250000),
				new V(636065492400000000,64.37250000),
				new V(636065493000000000,64.37750000),
				new V(636065493600000000,64.39500000),
				new V(636065494200000000,64.40250000),
				new V(636065494800000000,64.38500000),
				new V(636065495400000000,64.39250000),
				new V(636065496000000000,64.40000000),
				new V(636065496600000000,64.39250000),
				new V(636065497200000000,64.39500000),
				new V(636065497800000000,64.35250000),
				new V(636065498400000000,64.35000000),
				new V(636065499000000000,64.36250000),
				new V(636065499600000000,64.36000000),
				new V(636065500200000000,64.35500000),
				new V(636065500800000000,64.37250000),
				new V(636065501400000000,64.35500000),
				new V(636065502000000000,64.35000000),
				new V(636065504400000000,64.36000000),
				new V(636065505000000000,64.37750000),
				new V(636065505600000000,64.39000000),
				new V(636065506200000000,64.39000000),
				new V(636065506800000000,64.38500000),
				new V(636065508000000000,64.38000000),
				new V(636065508600000000,64.35750000),
				new V(636065509200000000,64.36000000),
				new V(636065509800000000,64.37500000),
				new V(636065511000000000,64.37250000),
				new V(636065511600000000,64.39500000),
				new V(636065512200000000,64.40750000),
				new V(636065512800000000,64.39750000),
				new V(636065513400000000,64.39750000),
				new V(636065514000000000,64.40750000),
				new V(636065514600000000,64.40750000),
				new V(636065515200000000,64.40500000),
				new V(636065515800000000,64.41000000),
				new V(636065516400000000,64.41000000),
				new V(636065517000000000,64.39750000),
				new V(636065517600000000,64.38000000),
				new V(636065518200000000,64.37500000),
				new V(636065518800000000,64.36500000),
				new V(636065519400000000,64.35500000),
				new V(636065520000000000,64.33000000),
				new V(636065520600000000,64.33000000),
				new V(636065521200000000,64.34000000),
				new V(636065521800000000,64.34000000),
				new V(636065522400000000,64.36000000),
				new V(636065523000000000,64.33000000),
				new V(636065523600000000,64.33750000),
				new V(636065524800000000,64.34500000),
				new V(636065525400000000,64.35500000),
				new V(636065526000000000,64.36000000),
				new V(636065526600000000,64.37000000),
				new V(636065527200000000,64.37000000),
				new V(636065527800000000,64.34750000),
				new V(636065528400000000,64.33750000),
				new V(636065529000000000,64.35000000),
				new V(636065529600000000,64.35750000),
				new V(636065530200000000,64.34750000),
				new V(636065530800000000,64.33250000),
				new V(636065531400000000,64.33000000),
				new V(636065532000000000,64.38000000),
				new V(636065532600000000,64.35500000),
				new V(636065534400000000,64.35750000),
				new V(636065535000000000,64.34000000),
				new V(636065536200000000,64.35250000),
				new V(636065536800000000,64.35250000),
				new V(636065537400000000,64.34250000),
				new V(636065538000000000,64.34250000),
				new V(636065538600000000,64.33750000),
				new V(636065539800000000,64.35750000),
				new V(636065541600000000,64.34500000),
				new V(636065542200000000,64.35500000),
				new V(636065542800000000,64.35750000),
				new V(636065544600000000,64.33500000),
				new V(636065545200000000,64.36500000),
				new V(636065545800000000,64.33500000),
				new V(636065546400000000,64.36000000),
				new V(636065547000000000,64.36000000),
				new V(636065547600000000,64.36000000),
				new V(636065548200000000,64.36500000),
				new V(636065548800000000,64.36000000),
				new V(636065549400000000,64.36250000),
				new V(636065550000000000,64.36750000),
				new V(636065550600000000,64.35000000),
				new V(636065551200000000,64.34750000),
				new V(636065551800000000,64.34250000),
				new V(636065552400000000,64.34250000),
				new V(636065553000000000,64.34250000),
				new V(636065554200000000,64.34250000),
				new V(636065554800000000,64.34000000),
				new V(636065555400000000,64.34500000),
				new V(636065556000000000,64.32500000),
				new V(636065556600000000,64.32000000),
				new V(636065557200000000,64.32000000),
				new V(636065557800000000,64.31750000),
				new V(636065558400000000,64.32000000),
				new V(636065559000000000,64.32000000),
				new V(636065559600000000,64.32500000),
				new V(636065560200000000,64.32250000),
				new V(636065560800000000,64.30500000),
				new V(636065561400000000,64.32500000),
				new V(636065928000000000,64.22000000),
				new V(636065928600000000,64.22000000),
				new V(636065929200000000,64.22500000),
				new V(636065929800000000,64.22000000),
				new V(636065930400000000,64.15000000),
				new V(636065931000000000,64.12000000),
				new V(636065931600000000,64.15000000),
				new V(636065932200000000,64.14500000),
				new V(636065932800000000,64.10000000),
				new V(636065933400000000,64.11750000),
				new V(636065934000000000,64.12000000),
				new V(636065934600000000,64.11750000),
				new V(636065935200000000,64.13000000),
				new V(636065935800000000,64.13000000),
				new V(636065936400000000,64.12500000),
				new V(636065937000000000,64.14250000),
				new V(636065937600000000,64.18250000),
				new V(636065938200000000,64.23000000),
				new V(636065938800000000,64.25000000),
				new V(636065939400000000,64.25500000),
				new V(636065940000000000,64.25500000),
				new V(636065940600000000,64.25500000),
				new V(636065941200000000,64.25000000),
				new V(636065941800000000,64.25750000),
				new V(636065942400000000,64.30250000),
				new V(636065943000000000,64.28500000),
				new V(636065943600000000,64.26000000),
				new V(636065944200000000,64.25000000),
				new V(636065944800000000,64.24000000),
				new V(636065945400000000,64.22750000),
				new V(636065946000000000,64.22750000),
				new V(636065946600000000,64.21000000),
				new V(636065947200000000,64.23000000),
				new V(636065947800000000,64.22250000),
				new V(636065948400000000,64.25250000),
				new V(636065949000000000,64.28000000),
				new V(636065949600000000,64.33000000),
				new V(636065950200000000,64.30500000),
				new V(636065950800000000,64.28500000),
				new V(636065951400000000,64.30250000),
				new V(636065952000000000,64.30000000),
				new V(636065952600000000,64.31250000),
				new V(636065953200000000,64.31000000),
				new V(636065953800000000,64.35250000),
				new V(636065954400000000,64.35500000),
				new V(636065955000000000,64.40000000),
				new V(636065955600000000,64.41500000),
				new V(636065956200000000,64.42000000),
				new V(636065956800000000,64.41500000),
				new V(636065957400000000,64.41250000),
				new V(636065958000000000,64.44250000),
				new V(636065958600000000,64.44500000),
				new V(636065959200000000,64.41500000),
				new V(636065959800000000,64.39500000),
				new V(636065960400000000,64.36250000),
				new V(636065961000000000,64.35000000),
				new V(636065961600000000,64.39000000),
				new V(636065962200000000,64.44000000),
				new V(636065962800000000,64.40250000),
				new V(636065963400000000,64.44250000),
				new V(636065964000000000,64.45000000),
				new V(636065964600000000,64.45000000),
				new V(636065965200000000,64.45000000),
				new V(636065965800000000,64.43250000),
				new V(636065966400000000,64.47000000),
				new V(636065967000000000,64.47750000),
				new V(636065967600000000,64.50250000),
				new V(636065968200000000,64.59750000),
				new V(636065968800000000,64.54000000),
				new V(636065969400000000,64.56000000),
				new V(636065970000000000,64.52000000),
				new V(636065970600000000,64.49000000),
				new V(636065971200000000,64.50000000),
				new V(636065971800000000,64.54250000),
				new V(636065972400000000,64.53500000),
				new V(636065973000000000,64.57500000),
				new V(636065973600000000,64.60000000),
				new V(636065974200000000,64.55500000),
				new V(636065974800000000,64.60000000),
				new V(636065975400000000,64.58250000),
				new V(636065976000000000,64.56000000),
				new V(636065976600000000,64.60500000),
				new V(636065977200000000,64.59000000),
				new V(636065977800000000,64.59000000),
				new V(636065978400000000,64.58500000),
				new V(636065979000000000,64.61000000),
				new V(636065979600000000,64.57500000),
				new V(636065980200000000,64.55000000),
				new V(636065980800000000,64.52500000),
				new V(636065981400000000,64.57000000),
				new V(636065982000000000,64.60500000),
				new V(636065982600000000,64.59250000),
				new V(636065983200000000,64.59500000),
				new V(636065983800000000,64.66250000),
				new V(636065984400000000,64.63750000),
				new V(636065985000000000,64.64000000),
				new V(636065985600000000,64.65500000),
				new V(636065986200000000,64.65750000),
				new V(636065986800000000,64.64500000),
				new V(636065987400000000,64.63750000),
				new V(636065988000000000,64.65250000),
				new V(636065988600000000,64.66250000),
				new V(636065989200000000,64.66000000),
				new V(636065989800000000,64.65500000),
				new V(636065990400000000,64.67000000),
				new V(636065991000000000,64.71500000),
				new V(636065991600000000,64.73750000),
				new V(636065992200000000,64.75750000),
				new V(636065992800000000,64.73250000),
				new V(636065993400000000,64.73000000),
				new V(636065994000000000,64.74000000),
				new V(636065994600000000,64.72250000),
				new V(636065995200000000,64.73000000),
				new V(636065995800000000,64.72500000),
				new V(636065996400000000,64.72750000),
				new V(636065997000000000,64.71500000),
				new V(636065997600000000,64.71000000),
				new V(636065998200000000,64.74500000),
				new V(636065998800000000,64.71250000),
				new V(636065999400000000,64.71000000),
				new V(636066000000000000,64.73500000),
				new V(636066000600000000,64.73250000),
				new V(636066001200000000,64.73500000),
				new V(636066001800000000,64.70000000),
				new V(636066002400000000,64.68000000),
				new V(636066003000000000,64.65750000),
				new V(636066003600000000,64.65500000),
				new V(636066004200000000,64.64500000),
				new V(636066004800000000,64.62250000),
				new V(636066005400000000,64.61250000),
				new V(636066006000000000,64.62750000),
				new V(636066006600000000,64.63750000),
				new V(636066007200000000,64.62500000),
				new V(636066007800000000,64.65000000),
				new V(636066008400000000,64.63500000),
				new V(636066009000000000,64.65750000),
				new V(636066009600000000,64.64500000),
				new V(636066010200000000,64.64750000),
				new V(636066010800000000,64.64750000),
				new V(636066011400000000,64.65750000),
				new V(636066012000000000,64.67000000),
				new V(636066012600000000,64.68000000),
				new V(636066013200000000,64.63250000),
				new V(636066013800000000,64.64250000),
				new V(636066014400000000,64.62500000),
				new V(636066015000000000,64.60000000),
				new V(636066015600000000,64.61000000),
				new V(636066016200000000,64.63500000),
				new V(636066016800000000,64.65750000),
				new V(636066017400000000,64.69750000),
				new V(636066018000000000,64.67500000),
				new V(636066018600000000,64.67500000),
				new V(636066019200000000,64.70000000),
				new V(636066019800000000,64.71250000),
				new V(636066020400000000,64.72500000),
				new V(636066021000000000,64.71000000),
				new V(636066021600000000,64.69250000),
				new V(636066022200000000,64.68250000),
				new V(636066022800000000,64.68750000),
				new V(636066023400000000,64.67500000),
				new V(636066024000000000,64.68250000),
				new V(636066024600000000,64.68000000),
				new V(636066025200000000,64.70250000),
				new V(636066025800000000,64.69250000),
				new V(636066026400000000,64.67750000),
				new V(636066027000000000,64.70000000),
				new V(636066027600000000,64.72500000),
				new V(636066028200000000,64.77000000),
				new V(636066028800000000,64.79000000),
				new V(636066029400000000,64.77500000),
				new V(636066030000000000,64.76750000),
				new V(636066030600000000,64.75750000),
				new V(636066031200000000,64.75000000),
				new V(636066031800000000,64.71250000),
				new V(636066032400000000,64.70750000),
				new V(636066033000000000,64.70000000),
				new V(636066033600000000,64.71000000),
				new V(636066034200000000,64.71000000),
				new V(636066034800000000,64.71000000),
				new V(636066035400000000,64.70500000),
				new V(636066036000000000,64.74250000),
				new V(636066036600000000,64.74000000),
				new V(636066037200000000,64.75250000),
				new V(636066037800000000,64.75000000),
				new V(636066038400000000,64.74500000),
				new V(636066039000000000,64.70750000),
				new V(636066039600000000,64.71250000),
				new V(636066040200000000,64.71500000),
				new V(636066040800000000,64.69500000),
				new V(636066041400000000,64.68250000),
				new V(636066042000000000,64.68750000),
				new V(636066042600000000,64.68500000),
				new V(636066043200000000,64.67500000),
				new V(636066043800000000,64.66000000),
				new V(636066044400000000,64.65750000),
				new V(636066045000000000,64.67000000),
				new V(636066045600000000,64.66000000),
				new V(636066046200000000,64.63250000),
				new V(636066046800000000,64.65500000),
				new V(636066047400000000,64.65000000),
				new V(636066048000000000,64.66250000),
				new V(636066048600000000,64.64750000),
				new V(636066049200000000,64.63750000),
				new V(636066049800000000,64.65000000),
				new V(636066050400000000,64.65000000),
				new V(636066051000000000,64.64750000),
				new V(636066051600000000,64.65500000),
				new V(636066052200000000,64.65250000),
				new V(636066052800000000,64.64500000),
				new V(636066053400000000,64.63750000),
				new V(636066054000000000,64.62500000),
				new V(636066054600000000,64.64000000),
				new V(636066055200000000,64.63750000),
				new V(636066055800000000,64.66250000),
				new V(636066056400000000,64.65000000),
				new V(636066057000000000,64.65500000),
				new V(636066057600000000,64.65500000),
				new V(636066058200000000,64.65000000),
				new V(636066058800000000,64.67250000),
				new V(636066059400000000,64.67500000),
				new V(636066060000000000,64.66250000),
				new V(636066060600000000,64.67750000),
				new V(636066061200000000,64.69000000),
				new V(636066061800000000,64.68250000),
				new V(636066062400000000,64.68250000),
				new V(636066063000000000,64.67750000),
				new V(636066063600000000,64.69000000),
				new V(636066064200000000,64.68500000),
				new V(636066064800000000,64.68000000),
				new V(636066065400000000,64.68500000),
				new V(636066066000000000,64.68000000),
				new V(636066066600000000,64.68250000),
				new V(636066067200000000,64.69000000),
				new V(636066067800000000,64.70250000),
				new V(636066068400000000,64.69750000),
				new V(636066069000000000,64.69500000),
				new V(636066069600000000,64.67750000),
				new V(636066070200000000,64.68000000),
				new V(636066070800000000,64.69000000),
				new V(636066071400000000,64.68000000),
				new V(636066072000000000,64.68500000),
				new V(636066072600000000,64.69000000),
				new V(636066073200000000,64.68000000),
				new V(636066073800000000,64.68750000),
				new V(636066074400000000,64.68500000),
				new V(636066075000000000,64.69000000),
				new V(636066075600000000,64.71500000),
				new V(636066076200000000,64.70000000),
				new V(636066076800000000,64.70500000),
				new V(636066077400000000,64.69750000),
				new V(636066078000000000,64.70250000),
				new V(636066078600000000,64.70500000),
				new V(636066079200000000,64.70000000),
				new V(636066079800000000,64.71000000),
				new V(636066080400000000,64.70750000),
				new V(636066081000000000,64.73000000),
				new V(636066081600000000,64.75500000),
				new V(636066082200000000,64.76750000),
				new V(636066082800000000,64.76500000),
				new V(636066083400000000,64.74750000),
				new V(636066084000000000,64.75000000),
				new V(636066084600000000,64.77000000),
				new V(636066085200000000,64.75000000),
				new V(636066085800000000,64.73750000),
				new V(636066086400000000,64.73500000),
				new V(636066087000000000,64.72000000),
				new V(636066087600000000,64.73000000),
				new V(636066088200000000,64.72750000),
				new V(636066088800000000,64.72000000),
				new V(636066089400000000,64.71750000),
				new V(636066090000000000,64.71750000),
				new V(636066090600000000,64.71000000),
				new V(636066091200000000,64.65750000),
				new V(636066091800000000,64.65500000),
				new V(636066092400000000,64.66000000),
				new V(636066093000000000,64.62750000),
				new V(636066093600000000,64.65500000),
				new V(636066094200000000,64.66000000),
				new V(636066094800000000,64.66500000),
				new V(636066095400000000,64.66750000),
				new V(636066096000000000,64.66500000),
				new V(636066096600000000,64.66500000),
				new V(636066097200000000,64.65500000),
				new V(636066097800000000,64.65500000),
				new V(636066098400000000,64.65750000),
				new V(636066099000000000,64.64000000),
				new V(636066099600000000,64.66250000),
				new V(636066100200000000,64.64750000),
				new V(636066100800000000,64.65750000),
				new V(636066101400000000,64.68750000),
				new V(636066102000000000,64.68750000),
				new V(636066102600000000,64.71500000),
				new V(636066103200000000,64.67000000),
				new V(636066103800000000,64.68750000),
				new V(636066104400000000,64.69000000),
				new V(636066105000000000,64.65250000),
				new V(636066105600000000,64.64000000),
				new V(636066106200000000,64.66500000),
				new V(636066106800000000,64.69000000),
				new V(636066107400000000,64.72500000),
				new V(636066108000000000,64.71500000),
				new V(636066108600000000,64.70750000),
				new V(636066109200000000,64.69750000),
				new V(636066109800000000,64.70000000),
				new V(636066110400000000,64.71000000),
				new V(636066111000000000,64.71000000),
				new V(636066111600000000,64.71250000),
				new V(636066112200000000,64.72750000),
				new V(636066112800000000,64.70500000),
				new V(636066113400000000,64.71500000),
				new V(636066114000000000,64.73500000),
				new V(636066114600000000,64.73500000),
				new V(636066115200000000,64.73000000),
				new V(636066115800000000,64.71500000),
				new V(636066116400000000,64.71500000),
				new V(636066117000000000,64.71750000),
				new V(636066117600000000,64.71000000),
				new V(636066118200000000,64.70000000),
				new V(636066118800000000,64.70250000),
				new V(636066119400000000,64.71750000),
				new V(636066120000000000,64.71750000),
				new V(636066120600000000,64.72500000),
				new V(636066121200000000,64.72000000),
				new V(636066121800000000,64.71500000),
				new V(636066122400000000,64.71500000),
				new V(636066123000000000,64.72250000),
				new V(636066123600000000,64.73750000),
				new V(636066124200000000,64.73750000),
				new V(636066124800000000,64.73750000),
				new V(636066125400000000,64.73250000),
				new V(636066126000000000,64.58500000),
				new V(636066126600000000,64.60250000),
				new V(636066127200000000,64.66750000),
				new V(636066127800000000,64.64500000),
				new V(636066128400000000,64.65000000),
				new V(636066129000000000,64.62000000),
				new V(636066129600000000,64.58500000),
				new V(636066130200000000,64.57250000),
				new V(636066130800000000,64.55250000),
				new V(636066131400000000,64.56250000),
				new V(636066132000000000,64.52500000),
				new V(636066132600000000,64.53250000),
				new V(636066133200000000,64.54000000),
				new V(636066133800000000,64.54250000),
				new V(636066134400000000,64.55000000),
				new V(636066135000000000,64.54500000),
				new V(636066135600000000,64.51750000),
				new V(636066136200000000,64.49000000),
				new V(636066136800000000,64.50750000),
				new V(636066137400000000,64.53000000),
				new V(636066138000000000,64.52750000),
				new V(636066138600000000,64.59500000),
				new V(636066139200000000,64.60000000),
				new V(636066139800000000,64.61750000),
				new V(636066140400000000,64.64500000),
				new V(636066141000000000,64.67750000),
				new V(636066141600000000,64.66750000),
				new V(636066142200000000,64.69500000),
				new V(636066142800000000,64.72250000),
				new V(636066143400000000,64.70000000),
				new V(636066144000000000,64.60250000),
				new V(636066144600000000,64.62500000),
				new V(636066145200000000,64.64000000),
				new V(636066145800000000,64.57750000),
				new V(636066146400000000,64.57500000),
				new V(636066147000000000,64.60000000),
				new V(636066147600000000,64.59250000),
				new V(636066148200000000,64.58500000),
				new V(636066148800000000,64.59750000),
				new V(636066149400000000,64.61500000),
				new V(636066150000000000,64.60500000),
				new V(636066150600000000,64.58500000),
				new V(636066151200000000,64.54250000),
				new V(636066151800000000,64.51750000),
				new V(636066152400000000,64.53000000),
				new V(636066153000000000,64.53500000),
				new V(636066153600000000,64.48500000),
				new V(636066154200000000,64.50000000),
				new V(636066154800000000,64.54750000),
				new V(636066155400000000,64.57500000),
				new V(636066156000000000,64.62000000),
				new V(636066156600000000,64.62000000),
				new V(636066157200000000,64.62750000),
				new V(636066157800000000,64.60000000),
				new V(636066158400000000,64.61000000),
				new V(636066159000000000,64.61000000),
				new V(636066159600000000,64.60000000),
				new V(636066160200000000,64.60500000),
				new V(636066160800000000,64.61000000),
				new V(636066161400000000,64.62500000),
				new V(636066162000000000,64.66750000),
				new V(636066162600000000,64.65500000),
				new V(636066163200000000,64.66000000),
				new V(636066163800000000,64.65750000),
				new V(636066164400000000,64.65000000),
				new V(636066165000000000,64.67000000),
				new V(636066165600000000,64.74000000),
				new V(636066166200000000,64.70750000),
				new V(636066166800000000,64.69000000),
				new V(636066167400000000,64.69750000),
				new V(636066168000000000,64.65500000),
				new V(636066168600000000,64.65000000),
				new V(636066169200000000,64.65250000),
				new V(636066169800000000,64.65250000),
				new V(636066170400000000,64.63000000),
				new V(636066171000000000,64.55750000),
				new V(636066171600000000,64.57750000),
				new V(636066172200000000,64.58000000),
				new V(636066172800000000,64.59500000),
				new V(636066173400000000,64.61000000),
				new V(636066174000000000,64.63250000),
				new V(636066174600000000,64.62000000),
				new V(636066175200000000,64.60000000),
				new V(636066175800000000,64.60750000),
				new V(636066176400000000,64.65000000),
				new V(636066177000000000,64.63750000),
				new V(636066177600000000,64.71250000),
				new V(636066178200000000,64.69250000),
				new V(636066178800000000,64.72000000),
				new V(636066179400000000,64.72000000),
				new V(636066180000000000,64.80750000),
				new V(636066180600000000,64.66000000),
				new V(636066181200000000,64.66000000),
				new V(636066181800000000,64.62750000),
				new V(636066182400000000,64.64000000),
				new V(636066183000000000,64.70000000),
				new V(636066183600000000,64.67250000),
				new V(636066184200000000,64.67000000),
				new V(636066184800000000,64.69750000),
				new V(636066185400000000,64.74750000),
				new V(636066186000000000,64.72250000),
				new V(636066186600000000,64.82750000),
				new V(636066187200000000,64.81750000),
				new V(636066187800000000,64.82750000),
				new V(636066188400000000,64.82750000),
				new V(636066189000000000,64.83000000),
				new V(636066189600000000,64.81500000),
				new V(636066190200000000,64.79750000),
				new V(636066190800000000,64.76250000),
				new V(636066191400000000,64.76500000),
				new V(636066192000000000,64.74500000),
				new V(636066192600000000,64.75000000),
				new V(636066193200000000,64.70500000),
				new V(636066193800000000,64.72000000),
				new V(636066194400000000,64.70750000),
				new V(636066195000000000,64.65000000),
				new V(636066195600000000,64.67500000),
				new V(636066196200000000,64.68500000),
				new V(636066196800000000,64.68250000),
				new V(636066197400000000,64.71250000),
				new V(636066198000000000,64.74000000),
				new V(636066198600000000,64.72000000),
				new V(636066199200000000,64.74500000),
				new V(636066199800000000,64.73500000),
				new V(636066200400000000,64.74750000),
				new V(636066201000000000,64.79000000),
				new V(636066201600000000,64.78750000),
				new V(636066202200000000,64.78500000),
				new V(636066202800000000,64.76750000),
				new V(636066203400000000,64.76000000),
				new V(636066204000000000,64.78000000),
				new V(636066204600000000,64.77000000),
				new V(636066205200000000,64.75750000),
				new V(636066205800000000,64.79500000),
				new V(636066206400000000,64.81250000),
				new V(636066207000000000,64.81500000),
				new V(636066207600000000,64.83000000),
				new V(636066208200000000,64.85500000),
				new V(636066208800000000,64.85000000),
				new V(636066209400000000,64.85000000),
				new V(636066210000000000,64.83500000),
				new V(636066210600000000,64.78750000),
				new V(636066211200000000,64.78500000),
				new V(636066211800000000,64.82000000),
				new V(636066212400000000,64.80500000),
				new V(636066213000000000,64.80000000),
				new V(636066213600000000,64.81000000),
				new V(636066214200000000,64.78250000),
				new V(636066214800000000,64.80000000),
				new V(636066215400000000,64.78750000),
				new V(636066216000000000,64.81000000),
				new V(636066216600000000,64.81250000),
				new V(636066217200000000,64.84750000),
				new V(636066217800000000,64.84000000),
				new V(636066218400000000,64.82000000),
				new V(636066219000000000,64.80250000),
				new V(636066219600000000,64.77500000),
				new V(636066220200000000,64.77250000),
				new V(636066220800000000,64.76250000),
				new V(636066221400000000,64.73250000),
				new V(636066222000000000,64.75500000),
				new V(636066222600000000,64.75750000),
				new V(636066223200000000,64.75000000),
				new V(636066223800000000,64.76500000),
				new V(636066224400000000,64.72250000),
				new V(636066225000000000,64.72000000),
				new V(636066225600000000,64.67000000),
				new V(636066226200000000,64.72000000),
				new V(636066226800000000,64.77000000),
				new V(636066227400000000,64.76000000),
				new V(636066228000000000,64.80000000),
				new V(636066228600000000,64.80250000),
				new V(636066229200000000,64.84000000),
				new V(636066229800000000,64.84250000),
				new V(636066230400000000,64.84250000),
				new V(636066231000000000,64.83750000),
				new V(636066231600000000,64.85500000),
				new V(636066232200000000,64.90500000),
				new V(636066232800000000,64.90000000),
				new V(636066233400000000,64.95500000),
				new V(636066234000000000,64.93500000),
				new V(636066234600000000,64.92500000),
				new V(636066235200000000,64.92250000),
				new V(636066235800000000,64.91250000),
				new V(636066236400000000,64.93750000),
				new V(636066237000000000,64.93000000),
				new V(636066237600000000,64.91250000),
				new V(636066238200000000,64.91000000),
				new V(636066238800000000,64.94000000),
				new V(636066239400000000,64.93500000),
				new V(636066240000000000,64.94500000),
				new V(636066240600000000,64.94000000),
				new V(636066241200000000,64.95000000),
				new V(636066241800000000,64.94250000),
				new V(636066242400000000,64.95000000),
				new V(636066243000000000,64.95000000),
				new V(636066243600000000,64.93750000),
				new V(636066244200000000,64.91250000),
				new V(636066244800000000,64.92000000),
				new V(636066245400000000,64.92750000),
				new V(636066246000000000,64.92250000),
				new V(636066246600000000,64.90750000),
				new V(636066247200000000,64.88250000),
				new V(636066247800000000,64.90000000),
				new V(636066248400000000,64.91250000),
				new V(636066249000000000,64.93000000),
				new V(636066249600000000,64.91500000),
				new V(636066250200000000,64.90500000),
				new V(636066250800000000,64.91000000),
				new V(636066251400000000,64.91000000),
				new V(636066252000000000,64.93500000),
				new V(636066252600000000,64.95000000),
				new V(636066253200000000,64.93250000),
				new V(636066253800000000,64.93250000),
				new V(636066254400000000,64.92250000),
				new V(636066255000000000,64.93250000),
				new V(636066255600000000,64.94000000),
				new V(636066256200000000,64.95000000),
				new V(636066256800000000,64.94750000),
				new V(636066257400000000,64.95000000),
				new V(636066258000000000,64.96500000),
				new V(636066258600000000,64.98000000),
				new V(636066259200000000,64.99250000),
				new V(636066259800000000,64.99250000),
				new V(636066260400000000,64.98000000),
				new V(636066261000000000,64.99250000),
				new V(636066261600000000,64.94000000),
				new V(636066262200000000,64.95750000),
				new V(636066262800000000,64.96000000),
				new V(636066263400000000,64.96000000),
				new V(636066264000000000,64.97500000)
			};
            #endregion

            for (int i = 0; i < vin.Length; i++)
                m_tcm.AddTemporalValue("signal", new AlfaFlow.TemporalValue<double>(vin[i].t, vin[i].v));
            var indSma = new AlfaFlow.IndSMA(m_tcm, "signal");
			smaTokenName = indSma.Token;

            indSma.SetParameters(new AlfaFlow.IndParameter("Period", 20));
            indSma.SetParameters(new AlfaFlow.IndParameter("Start", true), new AlfaFlow.IndParameter("KeepValues", true));
			/*
			m_tcm.AddTemporalObserver(new SignalObserver(this), new[] { "signal" }, true, AlfaFlow.TemporalContextManager.IndicatorPriority);
			m_tcm.AddTemporalObserver(new IndicatorObserver(this), new[] { "signal#SMA#Period=20" }, true, AlfaFlow.TemporalContextManager.IndicatorPriority);
			*/

			chartControl.Series.Add("signal", ViewType.Line);
			chartControl.Series["signal"].View.Color = Color.Red;
			chartControl.Series["signal"].ArgumentScaleType = ScaleType.DateTime;

			chartControl.Series.Add("indicator", ViewType.Line);
			chartControl.Series["indicator"].View.Color = Color.Green;
			chartControl.Series["indicator"].ArgumentScaleType = ScaleType.DateTime;
        }
        private void GraphForm_Shown(object sender, EventArgs e)
        {
            m_tcm.Run();

			var diag = chartControl.Diagram as XYDiagram;

			diag.AxisX.DateTimeScaleMode = DateTimeScaleMode.Manual;
			diag.AxisX.DateTimeMeasureUnit = DateTimeMeasurementUnit.Minute;
			diag.AxisX.DateTimeGridAlignment = DateTimeMeasurementUnit.Minute;
			diag.AxisX.DateTimeOptions.Format = DateTimeFormat.LongTime;

			diag.AxisX.AutoScaleBreaks.Enabled = false;
			diag.AxisX.ScaleBreakOptions.Style = ScaleBreakStyle.Waved;

			diag.AxisX.ScaleBreaks.Add(
				new ScaleBreak("night",
					new DateTime(2016, 8, 12, 00, 00, 0),
					new DateTime(2016, 8, 12, 9, 40, 0)));
			diag.AxisX.ScaleBreaks[0].Visible = true;

			var series = chartControl.Series["signal"];
			series.Points.AddRange(((AlfaFlow.TemporalStream<double>)m_tcm["signal"]).Select<AlfaFlow.TemporalValue<double>, SeriesPoint>(tv => new SeriesPoint(new DateTime((long)tv), (double)tv)).ToArray());

			series = chartControl.Series["indicator"];
			series.Points.AddRange(((AlfaFlow.TemporalStream<double>)m_tcm[smaTokenName]).Select<AlfaFlow.TemporalValue<double>, SeriesPoint>(tv => new SeriesPoint(new DateTime((long)tv), (double)tv)).ToArray());

			diag.AxisX.Range.Auto = false;

            diag.AxisX.Range.MaxValue = new DateTime(2016, 08, 12, 20, 0, 0);
			diag.AxisX.Range.MinValue = new DateTime(2016, 08, 11, 18, 0, 0);

        }

        internal class SignalObserver : AlfaFlow.ITemporalObserver<double>
        {
            GraphForm m_form;
            Series m_series;
            public SignalObserver(GraphForm form)
            {
                m_form = form;
                m_series = m_form.chartControl.Series[
                    m_form.chartControl.Series.Add("signal", ViewType.Line)];
                m_series.View.Color = Color.Red;
            }
            #region ITemporalObserver
            public void Reset()
            {
                m_series.Points.Clear();
            }

            public void Apply(AlfaFlow.TemporalValue<double> value)
            {
                m_series.Points.Add(new SeriesPoint(new DateTime((long)value), (double)value));
            }

			public void Apply(params AlfaFlow.TemporalValue<double>[] values)
            {
                Apply(values[0]);
            }
            #endregion
        }
		internal class IndicatorObserver : AlfaFlow.ITemporalObserver<double>
        {
            GraphForm m_form;
            Series m_series;
            public IndicatorObserver(GraphForm form)
            {
                m_form = form;
                m_series = m_form.chartControl.Series[
                    m_form.chartControl.Series.Add("indicator", ViewType.Line)];
                m_series.View.Color = Color.Green;
            }
            #region ITemporalObserver
            public void Reset()
            {
                m_series.Points.Clear();
            }

			public void Apply(AlfaFlow.TemporalValue<double> value)
            {
				m_series.Points.Add(new SeriesPoint(new DateTime((long)value), (double)value));
            }

			public void Apply(params AlfaFlow.TemporalValue<double>[] values)
            {
                Apply(values[0]);
            }
            #endregion
        }
    }
}
